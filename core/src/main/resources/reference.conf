popeye.pipeline.defaults {
  kafka {
    broker.list=""
    producer {
      dispatcher = "/kafka-producer"
      config=["kafka-producer.properties"]
      max-queued = 150000
      high-watermark = 2000000
      low-watermark = 10000
      tick = 500ms
      workers = 3
      dispatcher {
        type = "PinnedDispatcher"
        executor = "thread-pool-executor"
        thread-pool-executor.allow-core-pool-timeout = off
      }
    }
    consumer {
      config=["kafka-consumer.properties"]
      batch-size = 25000
      check-tick = 1s
      write-timeout = 60s
      max-lag = 3000s
      timeout = 10s
      dispatcher {
        type = "PinnedDispatcher"
        executor = "thread-pool-executor"
        thread-pool-executor.allow-core-pool-timeout = off
      }
    }
  }
  hbase {
    pool.max = 25
    dispatcher = "/hbase-writer"

    table {
      points = "tsdb"
      uids = "tsdb-uid"
    }

    uids {
      resolve-timeout = 10s
      metric { initial-capacity = 1000, max-capacity = 100000 }
      tagk { initial-capacity = 1000, max-capacity = 100000 }
      tagv { initial-capacity = 1000, max-capacity = 100000 }
    }
  }
  source {
    http {
      listen = "0.0.0.0:8080"
      backlog = 128
      produce.timeout = 30s
    }
    telnet {
      listen = "0.0.0.0:4444"
      batchSize = 5000
      high-watermark = 100
      low-watermark = 10
      produce.timeout = 30s
    }
  }
}

generator {
  datacenter = 0
}

akka {
  actor.deployment {
    /kafka-producer {
      router = round-robin
      nr-of-instances = 4
    }

    /hbase-writer {
      router = round-robin
      nr-of-instances = 1
    }
  }

  io.tcp {
    nr-of-selectors = 4
    received-message-size-limit = 64000
    max-channels = 30000
    batch-accept-limit = 500
  }

  loglevel = "INFO"
  loggers = ["akka.event.slf4j.Slf4jLogger"]
}

metrics.csv {
  enabled = false
  period = 5s
  directory = ./metrics
}

spray.can.server {
  idle-timeout = 10 s
  request-timeout = 5 s
  #request-chunk-aggregation-limit = 0
  parsing.illegal-header-warnings = off
}

